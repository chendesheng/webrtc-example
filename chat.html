<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<title></title>
	<style type="text/css">
		.video {
			position: relative;
			width: 500px;
			height: 500px;
		}
		
		video {
			width: 100%;
		}
		
		#me {
			width: 100px;
			position: absolute;
			z-index: 1;
			top: 5px;
			right: 5px;
		}
		
		#you {
			width: 100%;
			height: 100%;
		}
	</style>
	<script src="src/xirsys.p2p.adapter.js" type="text/javascript"></script>
	<script src="src/signaling.js" type="text/javascript"></script>
	<script src="src/p2pchat.js" type="text/javascript"></script>

	<script type="text/javascript">
		window.onload = function () {
			var $me = document.getElementById('me');
			var $you = document.getElementById('you');
			var $start = document.getElementById('start');
			var $stop = document.getElementById('stop');
			var $isCaller = document.getElementById('isCaller');
			var $localVideo = document.getElementById('localVideo');
			var $remoteVideo = document.getElementById('remoteVideo');

			var p2pChat = new P2PChat('default', false, $localVideo, $remoteVideo);

			p2pChat.onevent(function onVideoChatEvent(type, data) {
				console.log(type);
				if (type === 'error') {
					alert(data);
				} else if (type === 'disconnected') {
				}
			});

			$start.onclick = function onClickCall() {
				p2pChat.requirePermission(true, function () {
					console.log('permission grant');
					p2pChat.start(true, $isCaller.checked);
				}, function (err) {
					console.log(err)
				});
			};

			$stop.onclick = function onClickHangup() {
				p2pChat.stop();
			};
		};
	</script>
</head>

<body>
	<h3>
		Audio &amp; Video Chat Example
	</h3>
	<p>
		配置hosts：<br>120.199.9.10 hosted.comm100.com
	</p>
	<p>
		<label>Room: </label><input type="text" id="room" value="default" />
		<p>同一个room<strong>只能</strong>有两个人</p>
	</p>
	<p>
		<label>Is caller: </label><input type="checkbox" id="isCaller" /> 两个人里必须要有且只有一个caller
	</p>
	<P>
		<button id="start">Start</button>
		<button id="stop">Stop</button>
	</p>

	<div class="video">
		<div id="me">
			<video id="localVideo"></video>
		</div>
		<div id="you">
			<video id="remoteVideo"></video>
		</div>
	</div>
</body>

</html>